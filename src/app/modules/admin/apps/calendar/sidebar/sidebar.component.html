<h1 class="title">Calendar</h1>

<div class="calendars">

    <div class="header">
        <span class="title">Calendars</span>
        <mat-icon class="add"
                  [svgIcon]="'add'"
                  (click)="addCalendar()"></mat-icon>
    </div>

    <div class="calendar"
         *ngFor="let calendar of calendars">

        <div class="toggle"
             (click)="toggleCalendarVisibility(calendar)">

            <mat-icon class="visibility"
                      [ngClass]="'text-' + calendar.color"
                      [svgIcon]="calendar.visible ? 'check_box' : 'check_box_outline_blank'"></mat-icon>

            <span class="title">
                {{calendar.title}}
            </span>

        </div>

        <mat-icon class="edit"
                  [svgIcon]="'edit'"
                  (click)="openEditPanel(calendar)"></mat-icon>

    </div>

</div>

<!-- Edit panel -->
<ng-template #editPanel>

    <h4 class="title">
        <ng-container *ngIf="!calendar.id">Add calendar</ng-container>
        <ng-container *ngIf="calendar.id">Edit calendar</ng-container>
    </h4>

    <div class="row">

        <mat-select class="calendar-color-selector"
                    [(value)]="calendar.color"
                    [panelClass]="'calendar-sidebar-calendar-edit-panel-color-select-panel'"
                    [disableOptionCentering]="true">
            <mat-select-trigger>
                <mat-icon [ngClass]="'text-' + calendar.color"
                          [svgIcon]="'color_lens'"></mat-icon>
            </mat-select-trigger>
            <div class="color-box-title">Calendar color</div>
            <div class="color-box-container">
                <mat-option *ngFor="let color of calendarColors"
                            [value]="color"
                            #matOption="matOption">
                    <mat-icon [ngClass]="color"
                              *ngIf="matOption.selected"
                              [svgIcon]="'check'"></mat-icon>
                    <span class="color-box"
                          [ngClass]="color"></span>
                </mat-option>
            </div>
        </mat-select>

        <mat-form-field class="asm-mat asm-mat-no-label asm-mat-no-subscript asm-mat-no-underline"
                        [appearance]="'fill'">
            <input matInput
                   [(ngModel)]="calendar.title"
                   required>
        </mat-form-field>

    </div>

    <div class="actions">

        <button mat-button
                (click)="deleteCalendar(calendar)">
            Delete
        </button>

        <button mat-flat-button
                *ngIf="calendar.id"
                [color]="'primary'"
                [disabled]="!calendar.title"
                (click)="saveCalendar(calendar)">
            Update
        </button>

        <button mat-flat-button
                *ngIf="!calendar.id"
                [color]="'primary'"
                [disabled]="!calendar.title"
                (click)="saveCalendar(calendar)">
            Add
        </button>

    </div>

</ng-template>

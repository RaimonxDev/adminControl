<div class="content-layout fullwidth-standard-inner-scroll">

    <!-- Main -->
    <div class="main">

        <!-- Header -->
        <div class="header">

            <!-- Title -->
            <div class="title">
                <h1>Inventory</h1>
            </div>

            <!-- Main actions -->
            <div class="main-actions">

                <!-- Search -->
                <div class="search">

                    <mat-form-field class="asm-mat-dense asm-mat-no-subscript">
                        <mat-icon matPrefix
                                  [svgIcon]="'search'"></mat-icon>
                        <input matInput
                               [formControl]="searchInputControl"
                               [autocomplete]="'off'"
                               [placeholder]="'Search products'">
                    </mat-form-field>

                </div>

                <!-- Add product button -->
                <button class="add-product"
                        mat-flat-button
                        [color]="'primary'">
                    <mat-icon [svgIcon]="'add'"></mat-icon>
                    Add
                </button>

            </div>

            <div class="loader"
                 *ngIf="isLoading">
                <mat-progress-bar [mode]="'indeterminate'"></mat-progress-bar>
            </div>

        </div>

        <!-- Products list -->
        <div class="products-list">

            <ng-container *ngIf="productsCount > 0; else noProducts">

                <div class="table-wrapper">

                    <!-- Table -->
                    <table [ngClass]="{loading: isLoading}"
                           mat-table
                           matSort
                           [matSortActive]="'name'"
                           [matSortDisableClear]="true"
                           [matSortDirection]="'asc'"
                           [dataSource]="products$"
                           [trackBy]="trackByFn">

                        <!-- SKU -->
                        <ng-container matColumnDef="sku">
                            <th mat-header-cell
                                *matHeaderCellDef
                                mat-sort-header
                                disableClear>
                                SKU
                            </th>
                            <td mat-cell
                                *matCellDef="let product">
                                <div class="sku-content">
                                    <span class="thumbnail">
                                        <img *ngIf="product.thumbnail"
                                             [src]="product.thumbnail">
                                        <span *ngIf="!product.thumbnail">
                                            No Image
                                        </span>
                                    </span>
                                    <span class="sku">{{product.sku}}</span>
                                </div>
                            </td>
                        </ng-container>

                        <!-- Name -->
                        <ng-container matColumnDef="name">
                            <th mat-header-cell
                                *matHeaderCellDef
                                mat-sort-header
                                disableClear>
                                Name
                            </th>
                            <td mat-cell
                                *matCellDef="let product">
                                {{product.name}}
                            </td>
                        </ng-container>

                        <!-- Price -->
                        <ng-container matColumnDef="price">
                            <th mat-header-cell
                                *matHeaderCellDef
                                mat-sort-header
                                disableClear>
                                Price
                            </th>
                            <td mat-cell
                                *matCellDef="let product">
                                {{product.price | currency:'USD':'symbol':'1.2-2'}}
                            </td>
                        </ng-container>

                        <!-- Stock -->
                        <ng-container matColumnDef="stock">
                            <th mat-header-cell
                                *matHeaderCellDef
                                mat-sort-header
                                disableClear>
                                Stock
                            </th>
                            <td mat-cell
                                *matCellDef="let product">
                                <span class="flex items-center">
                                    <span class="min-w-4">{{product.stock}}</span>
                                    <!-- Low stock -->
                                    <span class="flex items-end ml-2 w-1 h-4 bg-red-200 rounded overflow-hidden"
                                          *ngIf="product.stock < 20">
                                        <span class="flex w-full h-1/3 bg-red-600"></span>
                                    </span>
                                    <!-- Medium stock -->
                                    <span class="flex items-end ml-2 w-1 h-4 bg-orange-200 rounded overflow-hidden"
                                          *ngIf="product.stock >= 20 && product.stock < 30">
                                        <span class="flex w-full h-2/4 bg-orange-400"></span>
                                    </span>
                                    <!-- High stock -->
                                    <span class="flex items-end ml-2 w-1 h-4 bg-green-100 rounded overflow-hidden"
                                          *ngIf="product.stock >= 30">
                                        <span class="flex w-full h-full bg-green-400"></span>
                                    </span>
                                </span>
                            </td>
                        </ng-container>

                        <!-- Active -->
                        <ng-container matColumnDef="active">
                            <th mat-header-cell
                                *matHeaderCellDef
                                mat-sort-header
                                disableClear>
                                Active
                            </th>
                            <td mat-cell
                                *matCellDef="let product">
                                <mat-icon class="text-green icon-size-20"
                                          *ngIf="product.active"
                                          [svgIcon]="'check'"></mat-icon>
                                <mat-icon class="text-cool-gray-300 icon-size-20"
                                          *ngIf="!product.active"
                                          [svgIcon]="'close'"></mat-icon>
                            </td>
                        </ng-container>

                        <!-- Actions -->
                        <ng-container matColumnDef="actions">
                            <th mat-header-cell
                                *matHeaderCellDef>
                                Details
                            </th>
                            <td mat-cell
                                *matCellDef="let product">
                                <button mat-icon-button>
                                    <mat-icon [svgIcon]="'expand_more'"></mat-icon>
                                </button>
                            </td>
                        </ng-container>

                        <tr mat-header-row
                            *matHeaderRowDef="productsTableColumns; sticky: true"></tr>
                        <tr class="product-row"
                            mat-row
                            *matRowDef="let row; columns: productsTableColumns;"></tr>

                    </table>

                </div>

                <mat-paginator [ngClass]="{loading: isLoading}"
                               [length]="pagination.length"
                               [pageIndex]="pagination.page"
                               [pageSize]="pagination.size"
                               [pageSizeOptions]="[5, 10, 25, 100]"
                               [showFirstLastButtons]="true"
                               (page)="pageChanged($event)"></mat-paginator>

            </ng-container>

            <ng-template #noProducts>
                <div class="no-products">There are no products!</div>
            </ng-template>

        </div>

    </div>

</div>
